<!DOCTYPE html>

<html lang="en" class="no-js">
<!--<![endif]-->

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />

  <title>PSA Lookup</title>

  <script type="text/javascript">
    (function() {
      if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
        var d = document,
          c = "appendChild",
          a = d.createElement("style");
        a[c](d.createTextNode("@-ms-viewport{width:auto!important}"));
        d.getElementsByTagName("head")[0][c](a);
      }
    })();
  </script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/template/assets/images/opengraph-image.png">

  <link rel="stylesheet" href="/public/application.css" />
  <link rel="stylesheet" href="/public/govuk-template.css" />

  <meta name="format-detection" content="telephone=no" />
</head>

<body class="">
  <script type="text/javascript">
    document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');
  </script>
  <div id="skiplink-container">
    <div>
      <a href="#content" class="skiplink">Skip to main content</a>
    </div>
  </div>

  <header role="banner" id="global-header" class=" with-proposition ">
    <div class="header-wrapper">
      <div class="header-global">
        <div class="header-logo">
          <a href="https://www.gov.uk/" title="Go to the GOV.UK homepage" data-journey-click="header:Click:GOV UK" id="logo" class="content">
            <img src="/public/images/gov.uk_logotype_crown.png" alt=""> GOV.UK
          </a>
        </div>

      </div>
      <div class="header-proposition">
        <div class="content">

          <a href="#proposition-links" class="js-header-toggle menu">Menu</a>

          <nav id="proposition-menu" class="header__menu" role="navigation">

            <span class="header__menu__proposition-name">Protect your lifetime allowance</span>
            <ul id="proposition-links" class="header__menu__proposition-links">

            </ul>

          </nav>
        </div>
      </div>
    </div>
  </header>

  <div id="global-cookie-message">
    <p>GOV.UK uses cookies to make the site simpler. <a href="/help/cookies">Find out more about cookies</a></p>
  </div>

  <main id="wrapper" role="main">
    <div class="centered-content">
      <div class="service-info" style="border-top: 10px solid #005ea5">
        <div class="logo">
          <span class="organisation-logo organisation-logo-medium">HM Revenue &amp; Customs</span>
        </div>
      </div>

    </div>
    <div id="content">

      <article class="content__body">

        <p class="">English | Cymraeg</p>

        <h1 class="heading-48 heading--underlined"> PSA Lookup form</h1>

        <p> Input a Pension scheme administrator check reference and client Lifetime Allowance reference to find out whether a pension has Lifetime Allowance protection.
        </p>

        <div class="flash error-summary " id="error-summary-display" role="alert" aria-labelledby="error-summary-heading" tabindex="-1">
          <h2 id="error-summary-heading" class="h3-heading">There are errors on this page</h2>
          <ul class="js-error-summary-messages" id="errorsummarylist">
          </ul>
        </div>

        <form>
          <div class="form-group">
            <fieldset class="form-field-group">

              <div id="psaref" class="form-field form-field--tall">

                <label> <h2 style="width: 592px"> Pension Scheme Administrator Check Reference </h2>
                    <div id="psareferr"></div>
                    <p class="form-field--hint">Example: PSA12345678A</p>
                    <input type="text" name="pensionSchemeAdministratorCheckReference" id="pensionSchemeAdministratorCheckReference"
                    class="input--medium input--cleared"/>
                </label>

              </div>

              <div id="ltaref" class="form-field">

                <label> <h2> Lifetime Allowance Reference </h2>
                    <div id="ltareferr"></div>
                    <p class="form-field--hint">Example: IP141000000000A</p>
                    <input type="text" name="lifetimeAllowanceReference" id="lifetimeAllowanceReference"
                    class="input--medium input--cleared"/>
                </label>

              </div>

            </fieldset>
          </div>
          <input class="button" type="submit" name="submit" value="Submit" onclick="formvalidate();return false">
        </form>

      </article>

      <div class="report-error">
        <script type="text/javascript">
          var reportProblemAjaxUrl = "http://localhost:9250/contact/problem_reports_ajax?service=PLA";
        </script>
        <a class="report-error__toggle js-visible" id="get-help-action" href="form-label">Get help with this page.</a>
        <a class="report-error__toggle js-hidden" href="http://localhost:9250/contact/problem_reports_nonjs?service=PLA">Get help with this page.</a>
        <div id="report-error-partial-form" class="report-error__content hidden">
          <div class="report-error__loading"></div>
        </div>
      </div>

    </div>
  </main>


  <footer class="group js-footer" id="footer" role="contentinfo">

    <div class="footer-wrapper">

      <div class="footer-meta">
        <div class="footer-meta-inner">

          <ul class="platform-help-links">
            <li><a href="/help/cookies" target="_blank" data-sso="false" data-journey-click="footer:Click:Cookies">Cookies</a></li>
            <li><a href="/help/privacy" target="_blank" data-sso="false" data-journey-click="footer:Click:Privacy policy">Privacy policy</a></li>
            <li><a href="/help/terms-and-conditions" target="_blank" data-sso="false" data-journey-click="footer:Click:Terms and conditions">Terms and conditions</a></li>
            <li><a href="https://www.gov.uk/help" target="_blank" data-sso="false" data-journey-click="footer:Click:Help">Help using GOV.UK</a></li>
          </ul>

          <div class="open-government-licence">
            <h2><a href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3" target="_blank"><img src="/public/images/open-government-licence_2x.png" style="width: 43px; height: 17px" alt="Open Government Licence"></a></h2>
            <p>All content is available under the <a href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3" target="_blank">Open Government Licence v3.0</a>, except where otherwise stated</p>
          </div>
        </div>

        <div class="copyright">
          <a href="http://www.nationalarchives.gov.uk/information-management/our-services/crown-copyright.htm" target="_blank">&copy; Crown Copyright</a>
        </div>
      </div>
    </div>
  </footer>

  <!--end footer-->

  <div id="global-app-error" class="app-error hidden"></div>

  <script type="text/javascript">
    var ssoUrl = "";
  </script>
  <script src="http://localhost:9032/assets/2.222.0/javascripts/application.min.js" type="text/javascript"></script>

  <script>
    function psarefvalidate(input) {
      var psaregex = /^PSA[0-9]{8}[A-Z]$/;
      var result = psaregex.test(input) ? false : true;
      return result;
    }

    function ltarefvalidate(input) {
      var ltaregex1 = /^IP14[0-9]{10}[ABCDEFGHJKLMNPRSTXYZ]$/;
      var ltaregex2 = /^IP16[0-9]{10}[ABCDEFGHJKLMNPRSTXYZ]$/;
      var ltaregex3 = /^FP16[0-9]{10}[ABCDEFGHJKLMNPRSTXYZ]$/;
      var tpsregex = /^[1-9A][0-9]{6}[ABCDEFHXJKLMNYPQRSTZW]$/;
      var result = (ltaregex1.test(input) || ltaregex2.test(input) || ltaregex3.test(input) || tpsregex.test(input)) ? false : true;
      return result;
    }

    function formvalidate() {
      var psaref, ltaref, psareferr, ltareferr, err, errorsummarylist;

      err = false;

      errorsummarylist = document.getElementById("errorsummarylist");
      ltareferr = "";
      psareferr = "";

      psaref = document.getElementById("pensionSchemeAdministratorCheckReference").value;
      ltaref = document.getElementById("lifetimeAllowanceReference").value;

      //PSA ref validation
      if (psaref == "") {
        psareferr = "PSA Ref must be entered";
        document.getElementById("psareferr").innerHTML = psareferr;
        document.getElementById("psareferr").className = "error-notification";
        document.getElementById("psaref").className = "form-field form-field--error fields-aligned form-field--tall";
        err = true;
      } else if (psarefvalidate(psaref.toUpperCase())) {
        psareferr = "PSA Ref must be in correct format";
        document.getElementById("psareferr").innerHTML = psareferr;
        document.getElementById("psareferr").className = "error-notification";
        document.getElementById("psaref").className = "form-field form-field--error fields-aligned form-field--tall";
        err = true;
      } else {
        document.getElementById("psareferr").innerHTML = "";
        document.getElementById("psareferr").className = "";
        document.getElementById("psaref").className = "form-field form-field--tall";
      }

      //LTA ref validation
      if (ltaref == "") {
        ltareferr = "LTA Ref must be entered";
        document.getElementById("ltareferr").innerHTML = ltareferr;
        document.getElementById("ltareferr").className = "error-notification";
        document.getElementById("ltaref").className = "form-field form-field--error fields-aligned";
        err = true;
      } else if (ltarefvalidate(ltaref.toUpperCase())) {
        ltareferr = "LTA Ref must be in correct format";
        document.getElementById("ltareferr").innerHTML = ltareferr;
        document.getElementById("ltareferr").className = "error-notification";
        document.getElementById("ltaref").className = "form-field form-field--error fields-aligned";
        err = true;
      } else {
        document.getElementById("ltareferr").innerHTML = "";
        document.getElementById("ltareferr").className = "";
        document.getElementById("ltaref").className = "form-field";
      }

      while (errorsummarylist.firstChild) {
        errorsummarylist.removeChild(errorsummarylist.firstChild);
      }

      if (err) {
        document.getElementById("error-summary-display").className = "flash error-summary error-summary--show";
        if (psareferr != "") {
          var entry = document.createElement('li');
          entry.appendChild(document.createTextNode(psareferr));
          errorsummarylist.appendChild(entry);
        }
        if (ltareferr != "") {
          var entry = document.createElement('li');
          entry.appendChild(document.createTextNode(ltareferr));
          errorsummarylist.appendChild(entry);
        }
      } else {
        document.getElementById("error-summary-display").className = "flash error-summary";
        switch (psaref.toUpperCase()) {
          case "PSA12345678A":
            window.location.href = "https://smudgey.github.io/result1";
            break;
          case "PSA12345678B":
            window.location.href = "https://smudgey.github.io/result2";
            break;
          case "PSA12345678C":
            window.location.href = "https://smudgey.github.io/result3";
            break;
          case "PSA12345678D":
            window.location.href = "https://smudgey.github.io/result4";
            break;
          case "PSA12345678E":
            window.location.href = "https://smudgey.github.io/result5";
            break;
          case "PSA12345678F":
            window.location.href = "https://smudgey.github.io/result6";
            break;
          case "PSA12345678G":
            window.location.href = "https://smudgey.github.io/result7";
            break;
          default:
            document.getElementById("error-summary-display").className = "flash error-summary error-summary--show";
            var entry = document.createElement('li');
            entry.appendChild(document.createTextNode("The details you entered do not have a valid protection"));
            errorsummarylist.appendChild(entry);
        }
      }
    }
  </script>

</body>

</html>
